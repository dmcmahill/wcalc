# $Id: Makefile.in,v 1.7 2001/02/17 16:56:34 dan Exp $

#
# Copyright (c) 2001 Dan McMahill
# All rights reserved.
#
# This code is derived from software written by Dan McMahill
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#        This product includes software developed by Dan McMahill
#  4. The name of the author may not be used to endorse or promote products
#     derived from this software without specific prior written permission.
# 
#  THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
#  IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
#  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
#  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
#  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
#  BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
#  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
#  AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
#  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
#  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
#  SUCH DAMAGE.
#

default: all

#SHELL = @SHELL@
@SET_MAKE@

VERSION =0.1

prefix = @prefix@
exec_prefix = @exec_prefix@
srcdir = @srcdir@


bindir = $(exec_prefix)/bin
mandir = @mandir@
sharedir = ${prefix}/share


INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_SCRIPT = @INSTALL_SCRIPT@
INSTALL_DATA = @INSTALL_DATA@

AWK = @AWK@
CC = @CC@
CFLAGS = @CFLAGS@ -DVER=\"${VERSION}\"
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@


CFILES = \
        about.c \
        files.c \
        mathutil.c \
        menus.c \
        microstrip.c \
        version.c \
        wcalc.c

OFILES = $(CFILES:.c=.o)

EXTRA_DEPENDS = 

PROG = wcalc

all:: $(PROG)

$(PROG):  $(OFILES) $(EXTRA_DEPENDS)
	$(CC) $(CFLAGS) -o $@ $(OFILES) $(LDFLAGS) $(LIBS)

clean:
	-rm *.o *.mat *~ $(PROG)

distclean: clean
	-rm configure config.log config.cache config.status

lint:
	$(LINT) $(INCLDIR) $(LIBDIR) $(CFILES)  2>&1 | more


###########################################
# the program
#
all:: $(PROG)

install:: install.bin

install.bin:: $(PROG) installdirs
	$(INSTALL_PROGRAM) $(PROG) ${prefix}/bin/$(PROG)

#
###########################################

###########################################
# The install directories
#

install:: installdirs

installdirs: mkinstalldirs
	$(srcdir)/mkinstalldirs $(bindir) $(mandir)/man1 $(mandir)/cat1 \

#
###########################################

###########################################
# The man page
install:: install.man

install.man: installdirs
	$(INSTALL_DATA) $(srcdir)/wcalc.1 $(mandir)/man1/wcalc.1

#
###########################################

###########################################
# the build stuff
#all:: configure Makefile

configure: configure.in
	autoconf

Makefile: Makefile.in configure
	./configure

#
###########################################

###########################################
#
DISTDIR=wcalc-${VERSION}

release: configure 
	rm -fr ${DISTDIR} ${DISTDIR}.tar.gz 
	mkdir ${DISTDIR} 
	tar -cf - `cat files` | (cd ${DISTDIR} && tar xf -) 
	tar -cvf - ${DISTDIR} | gzip > ${DISTDIR}.tar.gz 
	rm -fr ${DISTDIR}

#
###########################################

